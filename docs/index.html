<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Analysis of Hybrid Zones • bahz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Analysis of Hybrid Zones">
<meta property="og:description" content="A package to fit hybrid zone cline models in a Bayesian framework.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bahz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->
<p><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lfecycle experimental"></a> <img src="http://www.r-pkg.org/badges/version/bahz" alt="CRAN status"><!-- badges: end --></p>
<div id="bahz" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bahz" class="anchor"></a>bahz</h1></div>
<p>bahz (Bayesian Analysis of Hybrid Zones) is an R package for fitting and analyzing one-dimensional, geographic cline models in hybrid zones.</p>
<p>bahz is currently under active development.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Before installing bahz, you’ll need to install the R package RStan, which interfaces with the Stan modelling language. To install RStan, follow the instructions <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">here</a>.</p>
<p>Once Rstan is installed, you can install bahz from Github. If you don’t already have it, you’ll need to install the R package <a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)</code></pre></div>
<p>Then, you can install bahz:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"tjthurman/BAHZ"</span>) 
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(bahz)</code></pre></div>
<p>bahz is not currently available from CRAN. If you have any issues installing bahz, please <a href="https://github.com/tjthurman/BAHZ/issues">file an issue on GitHub</a>.</p>
</div>
<div id="how-to-use-bahz" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-use-bahz" class="anchor"></a>How to use bahz</h2>
<p>Though bahz is still under development, the core model-fitting functionality is operational. Here’s a mini-tutorial (with minimal explanation) on how to fit a hybrid zone model with bahz. There is further information in the help files for each function. A more complete tutorial is in the works.</p>
<div id="prepare-data" class="section level4">
<h4 class="hasAnchor">
<a href="#prepare-data" class="anchor"></a>Prepare Data</h4>
<p>To generate data to analyze, we can simulate genetic data from a one-dimenional genetic cline. bahz provides a function for performing this simulation, which automatically outputs the data in the format needed for downstream analyses. See the the help file at <code><a href="reference/prep_geno_data.html">?prep_geno_data</a></code> for information on supported formats.</p>
<p>Here, we will simulate a cline that was sampled across a 500 kilometer transect, with sampling sites every 15 kilometers and 30 individuals sampled at each site. For the cline, we will simulate a decreasing cline, with a cline center at 237 km, a width of 62 km, and minimim and maximum allele frequencies of 0.05 and 0.99, respectively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)
data &lt;-<span class="st"> </span><span class="kw"><a href="reference/sim_geno_cline.html">sim_geno_cline</a></span>(<span class="dt">transect_distances =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">15</span>), <span class="dt">n_ind =</span> <span class="dv">30</span>, <span class="dt">Fis =</span> <span class="dv">0</span>,
                       <span class="dt">decrease =</span> T, <span class="dt">center =</span> <span class="dv">237</span>, <span class="dt">width =</span> <span class="dv">62</span>, 
                       <span class="dt">pmin =</span> <span class="fl">0.05</span>, <span class="dt">pmax =</span> .<span class="dv">99</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(data)
<span class="co">#&gt;   site transectDist cline.p cline.f AA Aa aa  N emp.p emp.f</span>
<span class="co">#&gt; 1    1            0    0.99       0 30  0  0 30 1.000     0</span>
<span class="co">#&gt; 2    2           15    0.99       0 29  1  0 30 0.983     0</span>
<span class="co">#&gt; 3    3           30    0.99       0 28  2  0 30 0.967     0</span>
<span class="co">#&gt; 4    4           45    0.99       0 30  0  0 30 1.000     0</span>
<span class="co">#&gt; 5    5           60    0.99       0 30  0  0 30 1.000     0</span>
<span class="co">#&gt; 6    6           75    0.99       0 28  2  0 30 0.967     0</span></code></pre></div>
</div>
<div id="specify-priors" class="section level4">
<h4 class="hasAnchor">
<a href="#specify-priors" class="anchor"></a>Specify priors</h4>
<p>bahz fits Bayesian models, and thus users need to specify prior distributions for the parameters to be estimated. This is done through a prior configuration file. Users first generate a configuration file with the command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/make_prior_config.html">make_prior_config</a></span>()</code></pre></div>
<p>By default this will generate a configuration file template, <code>prior_config_template.yaml</code>, in the current working directory. Users can specify other file locations or names. Open the file and edit the priors as you see fit. For this tutorial, you can leave the priors at their default vaules.</p>
</div>
<div id="fit-the-model" class="section level4">
<h4 class="hasAnchor">
<a href="#fit-the-model" class="anchor"></a>Fit the model</h4>
<p>With our data and priors ready, we can now fit a cline model. For now, we will fit the simplest cline model, using the binomial model of allele frequencies and no introgression tails:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">456</span>)
cline.fit &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_geno_cline.html">fit_geno_cline</a></span>(<span class="dt">data =</span> data, <span class="dt">prior_file =</span> <span class="st">"prior_config_template.yaml"</span>,
                            <span class="dt">type =</span> <span class="st">"bi"</span>, <span class="dt">tails =</span> <span class="st">"none"</span>)</code></pre></div>
</div>
<div id="analyze-the-results" class="section level4">
<h4 class="hasAnchor">
<a href="#analyze-the-results" class="anchor"></a>Analyze the results</h4>
<p>We can summarize the posterior distribution of the cline parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/cline_summary.html">cline_summary</a></span>(cline.fit)
<span class="co">#&gt;    param   mean se_mean   sd low_0.95_HPDI up_0.95_HPDI n_eff Rhat</span>
<span class="co">#&gt; 1 center 237.48    0.04 2.41        232.50       242.03  4272    1</span>
<span class="co">#&gt; 2  width  67.62    0.09 6.01         56.19        79.63  4577    1</span>
<span class="co">#&gt; 3   pmin   0.04    0.00 0.01          0.03         0.05  4575    1</span>
<span class="co">#&gt; 4   pmax   0.99    0.00 0.00          0.98         0.99  5085    1</span>
<span class="co">#&gt; 5    dev 116.04    0.07 2.86        112.21       121.59  1740    1</span></code></pre></div>
<p>The model has done a good job. The point estimates of the parameters are quite close to the values we specified, and the 95% credible intervals contain the simulated values.</p>
<p>bahz provides some simple plotting functions for visualizating fitted clines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/plot_geno_cline.html">plot_geno_cline</a></span>(<span class="dt">stanfit =</span> cline.fit, <span class="dt">data =</span> data, <span class="dt">add.obs.freqs =</span> T, 
                <span class="dt">xlab =</span> <span class="st">"distance"</span>, <span class="dt">ylab =</span> <span class="st">"allele frequency"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>For users who wish to make higher-quality, customized plots, bahz has a helper function to calculate predicted allele frequencies from fitted clines. Those data can then be used in the plotting system of the user’s choice, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred_cline &lt;-<span class="st"> </span><span class="kw"><a href="reference/predict_cline.html">predict_cline</a></span>(<span class="dt">stanfit =</span> cline.fit, <span class="dt">distance =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">500</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(pred_cline)
<span class="co">#&gt;   transectDist         p</span>
<span class="co">#&gt; 1            0 0.9899992</span>
<span class="co">#&gt; 2            1 0.9899992</span>
<span class="co">#&gt; 3            2 0.9899992</span>
<span class="co">#&gt; 4            3 0.9899991</span>
<span class="co">#&gt; 5            4 0.9899990</span>
<span class="co">#&gt; 6            5 0.9899990</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use the ggplot2 package</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">data =</span> pred_cline, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> transectDist, <span class="dt">y =</span> p)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">color =</span> <span class="st">"orange"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">xlab</a></span>(<span class="st">"distance along transect"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">ylab</a></span>(<span class="st">"allele frequency"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_classic</a></span>()</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<pre><code>#&gt; Warning in citation("bahz"): no date field in DESCRIPTION file of package
#&gt; 'bahz'
#&gt; Warning in citation("bahz"): could not determine year for 'bahz' from
#&gt; package DESCRIPTION file
#&gt; 
#&gt; To cite package 'bahz' in publications use:
#&gt; 
#&gt;   Timothy Thurman (NA). bahz: Bayesian Analysis of Hybrid Zones. R
#&gt;   package version 0.0.0.9011.
#&gt; 
#&gt; A BibTeX entry for LaTeX users is
#&gt; 
#&gt;   @Manual{,
#&gt;     title = {bahz: Bayesian Analysis of Hybrid Zones},
#&gt;     author = {Timothy Thurman},
#&gt;     note = {R package version 0.0.0.9011},
#&gt;   }</code></pre>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>bahz is distributed for free under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU Public License v3</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing bahz</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Timothy Thurman <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Timothy Thurman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
