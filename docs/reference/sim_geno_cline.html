<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate genetic data from a cline — sim_geno_cline • bahz</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulate genetic data from a cline — sim_geno_cline" />

<meta property="og:description" content="This function generates a dataframe with simulated genotypic data sampled
from a genetic cline. The sampling sites, number of individuals, level of
inbreeding, and cline parameters are supplied by the user. Cline parameters
are flexible, and can model both sigmoid clines and stepped clines with
introgresison tails." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bahz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate genetic data from a cline</h1>
    
    <div class="hidden name"><code>sim_geno_cline.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function generates a dataframe with simulated genotypic data sampled
from a genetic cline. The sampling sites, number of individuals, level of
inbreeding, and cline parameters are supplied by the user. Cline parameters
are flexible, and can model both sigmoid clines and stepped clines with
introgresison tails.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sim_geno_cline</span>(<span class='no'>transect_distances</span>, <span class='no'>n_ind</span>, <span class='no'>Fis</span>, <span class='no'>decrease</span>, <span class='no'>center</span>, <span class='no'>width</span>,
  <span class='kw'>pmin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>pmax</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>deltaL</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>tauL</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>deltaR</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tauR</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>transect_distances</th>
      <td><p>The distances along the transect for the simulated
sampling sites. A numeric vector.</p></td>
    </tr>
    <tr>
      <th>n_ind</th>
      <td><p>The number of diploid individuals sampled at each site. Either a
single numeric value (for constant sampling), or a numeric vector equal in
length to <code>transect_distances</code>.</p></td>
    </tr>
    <tr>
      <th>Fis</th>
      <td><p>The inbreeding coefficient, Fis, for each site. Must be between 0
and 1 (inclusive). Either a single numeric value (for constant inbreeding),
or a numeric vector equal in length to <code>transect_distances</code>.</p></td>
    </tr>
    <tr>
      <th>decrease</th>
      <td><p>Is the cline decreasing in frequency? <code>TRUE</code> or
<code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>The location of the cline center, in the same distance units as
<code>transect_distances</code>. Numeric, must be greater than 0.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>The width of the cline, in the same distance units as
<code>transect_distances</code>. Numeric, must be greater than 0.</p></td>
    </tr>
    <tr>
      <th>pmin, pmax</th>
      <td><p>Optional. The minimum and maximum allele frequency values
in the tails of the cline. Default values are <code>0</code> and <code>1</code>, respectively.
Must be between 0 and 1 (inclusive). Numeric.</p></td>
    </tr>
    <tr>
      <th>deltaL, tauL</th>
      <td><p>Optional delta and tau parameters which describe the left
exponential tail. Must supply both to generate a tail. Default is <code>NULL</code> (no
tails). Numeric. tauL must be between 0 and 1 (inclusive).</p></td>
    </tr>
    <tr>
      <th>deltaR, tauR</th>
      <td><p>Optional delta and tau parameters which describe the right
exponential tail. Must supply both to generate a tail. Default is <code>NULL</code> (no
tails). Numeric. tauR must be between 0 and 1 (inclusive).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame of simulated genetic data sampled from the cline. Columns are:</p><ul>
<li><p>site: The site numbers, given sequentially starting at 1.</p></li>
<li><p>transectDist: The distance along the cline for each site.</p></li>
<li><p>cline.p: The expected allele frequency for each site, given its position on the cline.</p></li>
<li><p>cline.f: The expected coefficient of inbreeding for each site.</p></li>
<li><p>AA, Aa, aa: The simulated number of homozygotes and heterozygotes for each site.</p></li>
<li><p>N: The number of individuals sampled for each site.</p></li>
<li><p>emp.p: The observed allele frequency for each site (includes sampling error).</p></li>
<li><p>emp.f: The observed Fis for each site (includes sampling error).</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function calls <code><a href='general_cline_eqn.html'>general_cline_eqn</a></code> for each sampled point along the
cline to generate the expected allele frequency at that point. The calculated
allele frequency and provided Fis are then used to calculate the expected
genotype frequencies for each site, according to the equations:</p>
<p>$$AA = p^2 + p(1-p)Fis$$
$$Aa = 2p(1-p)(1-Fis)$$
$$aa = (1-p)^2 + p(1-p)Fis$$</p>
<p>Sampled genotypes are then drawn from a multinomial distribution, with the
expected genotype frequencies as the probabilities. From those sampled
genotypes, empirical allele frequencies (emp.p) and empirical Fis estimates
(emp.f) are calculated as:</p>
<p>$$emp.p = (2*AA + Aa)/N$$
$$emp.f = (Hexp - Hobs)/Hexp$$</p>
<p>where AA is the number of honozygotes of the focal allele, Aa is the number
of heterozygotes, N is the number of sampled individuals, and  Hexp and Hobs
are the expected and observed heterozygosity. Fis values are corrected with
<a href='correct_fis.html'>correct_fis</a>, such that empirical Fis values which are undefined or &lt; 0
are corrected to 0.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate genotype data from a decreasing cline</span>
<span class='co'># with center at 100, width of 30.</span>
<span class='co'># Sites are 20 units apart, from 0 to 200.</span>
<span class='co'># 20 individuals are sampled at each site.</span>
<span class='co'># Inbreeding is constant at Fis = 0.1.</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='fu'>sim_geno_cline</span>(<span class='kw'>transect_distance</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>200</span>,<span class='fl'>20</span>),
               <span class='kw'>n_ind</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>Fis</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
               <span class='kw'>decrease</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
               <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>30</span>)</div><div class='output co'>#&gt;    site transectDist cline.p cline.f AA Aa aa  N emp.p emp.f
#&gt; 1     1            0   1.000     0.1 20  0  0 20 1.000 0.000
#&gt; 2     2           20   1.000     0.1 20  0  0 20 1.000 0.000
#&gt; 3     3           40   1.000     0.1 20  0  0 20 1.000 0.000
#&gt; 4     4           60   0.995     0.1 19  1  0 20 0.975 0.000
#&gt; 5     5           80   0.935     0.1 20  0  0 20 1.000 0.000
#&gt; 6     6          100   0.500     0.1  6  6  8 20 0.450 0.394
#&gt; 7     7          120   0.065     0.1  0  2 18 20 0.050 0.000
#&gt; 8     8          140   0.005     0.1  0  0 20 20 0.000 0.000
#&gt; 9     9          160   0.000     0.1  0  0 20 20 0.000 0.000
#&gt; 10   10          180   0.000     0.1  0  0 20 20 0.000 0.000
#&gt; 11   11          200   0.000     0.1  0  0 20 20 0.000 0.000</div><div class='input'>
<span class='co'># Simulate genotype data from an increasing cline</span>
<span class='co'># with center at 272, width of 91.</span>
<span class='co'># The minimum and maximum allele frequencies</span>
<span class='co'># are 0.07 and 0.98, respectively, and</span>
<span class='co'># there is an introgression tail on the</span>
<span class='co'># left side with deltaL = 29 and tauL = 0.8.</span>

<span class='co'># Sites are 13 units apart, from 162 to 312.</span>
<span class='co'># At each site, the number of individuals sampled</span>
<span class='co'># is drawn from a random normal distribution with</span>
<span class='co'># mean = 25 and sd = 5</span>
<span class='co'># Inbreeding is constant at Fis = 0.</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>ind_sampling</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>162</span>,<span class='fl'>312</span>,<span class='fl'>12</span>)), <span class='fl'>25</span>, <span class='fl'>5</span>))
<span class='fu'>sim_geno_cline</span>(<span class='kw'>transect_distance</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>162</span>,<span class='fl'>312</span>,<span class='fl'>12</span>),
               <span class='kw'>n_ind</span> <span class='kw'>=</span> <span class='no'>ind_sampling</span>,
               <span class='kw'>Fis</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>decrease</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
               <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>272</span>, <span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>91</span>,
               <span class='kw'>pmin</span> <span class='kw'>=</span> <span class='fl'>0.07</span>, <span class='kw'>pmax</span> <span class='kw'>=</span> <span class='fl'>0.98</span>,
               <span class='kw'>deltaL</span> <span class='kw'>=</span> <span class='fl'>29</span>, <span class='kw'>tauL</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)</div><div class='output co'>#&gt;    site transectDist cline.p cline.f AA Aa aa  N emp.p emp.f
#&gt; 1     1          162   0.091       0  0  4 18 22 0.091 0.000
#&gt; 2     2          174   0.100       0  0  2 21 23 0.043 0.000
#&gt; 3     3          186   0.112       0  2  9 21 32 0.203 0.131
#&gt; 4     4          198   0.128       0  1  7 17 25 0.180 0.051
#&gt; 5     5          210   0.150       0  0  6 19 25 0.120 0.000
#&gt; 6     6          222   0.182       0  2  7 24 33 0.167 0.236
#&gt; 7     7          234   0.225       0  1  8 18 27 0.185 0.018
#&gt; 8     8          246   0.290       0  0  8 10 18 0.222 0.000
#&gt; 9     9          258   0.389       0  3 11  7 21 0.405 0.000
#&gt; 10   10          270   0.505       0  4 14  4 22 0.500 0.000
#&gt; 11   11          282   0.623       0 10 16  5 31 0.581 0.000
#&gt; 12   12          294   0.729       0 15  8  3 26 0.731 0.218
#&gt; 13   13          306   0.813       0 22  5  0 27 0.907 0.000</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Timothy Thurman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

